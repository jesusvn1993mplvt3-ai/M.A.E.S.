<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sweaters Liliana Base de datos 2026 v01</title>
    
    <link id="appIcon" rel="icon" href="https://raw.githubusercontent.com/jesusvn1993mplvt3-ai/CIRINEO/refs/heads/main/icon.ico">
    <link id="appAppleIcon" rel="apple-touch-icon" href="https://raw.githubusercontent.com/jesusvn1993mplvt3-ai/CIRINEO/refs/heads/main/icon.ico">
    <meta name="theme-color" content="#1e293b">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    
    <style>
        /* Tipograf√≠a: Usaremos una pila de fuentes sans-serif moderna */
        body {
            font-family: ui-sans-serif, system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
        }

        /* Estilos base para la tipograf√≠a y el fondo (Responsive) */
        .dashboard-grid {
            display: flex;
            flex-direction: column; /* M√≥vil: Apilado Verticalmente */
            min-height: 100vh;
        }
        
        /* Layout para Escritorio (lg: 1024px o m√°s) */
        @media (min-width: 1024px) {
            .dashboard-grid {
                display: grid;
                grid-template-columns: 1fr 320px; /* Contenido principal y barra lateral de 320px */
                height: 100vh;
                overflow: hidden; /* Evita scroll en el layout principal de escritorio */
            }
            .main-content, .sidebar {
                height: 100vh;
                overflow-y: auto; /* Permite scroll en cada secci√≥n si el contenido es largo */
            }
        }
        
        /* Animaci√≥n de Parpadeo (Flicker) para la cuadr√≠cula de estado */
        @keyframes flicker {
            0%, 100% { opacity: 0.95; }
            50% { opacity: 0.3; }
            52% { opacity: 0.6; }
            54% { opacity: 0.3; }
            56% { opacity: 0.95; }
        }
        
        /* Estilos del Radio y Scrollbars */
        .radio-list { max-height: 180px; overflow-y: auto; }
        .radio-list::-webkit-scrollbar { width: 6px; background-color: transparent; }
        .radio-list::-webkit-scrollbar-thumb { background: var(--accent-color); border-radius: 3px; }

    </style>
</head>
<body class="font-sans">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useMemo, useRef } = React;
        const Icon = ({ name, size = 20, className }) => {
            useEffect(() => { lucide.createIcons(); }, [name]);
            return <i data-lucide={name} width={size} height={size} className={className}></i>;
        };

        // --- Configuraci√≥n de Firebase (Se mantiene) ---
        const firebaseConfig = {
            apiKey: "AIzaSyBqHgV4vDat1-VmZfKbiPg7nuiX-ROcexw",
            authDomain: "cirineo-cec21.firebaseapp.com",
            projectId: "cirineo-cec21",
            storageBucket: "cirineo-cec21.firebasestorage.app",
            messagingSenderId: "620210618284",
            appId: "1:620210618284:web:482bab9bf74650fff18409",
            measurementId: "G-B7YLM78RVW"
        };

        if (!firebase.apps.length) firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // --- DEFINICI√ìN DE TEMAS ---
        const themeConfig = {
            darkIndustrial: {
                id: 'darkIndustrial',
                name: "Industrial Oscuro",
                primaryBg: "bg-slate-900",
                secondaryBg: "bg-slate-800",
                accentColor: "text-sky-400",
                warningColor: "text-red-400",
                textColor: "text-white",
                navBtnColor: "bg-indigo-600 hover:bg-indigo-700",
                widgetBg: "bg-slate-700/50 backdrop-blur-sm",
                clockBg: "bg-slate-700"
            },
            cleanLight: {
                id: 'cleanLight',
                name: "Claro Limpio",
                primaryBg: "bg-gray-100",
                secondaryBg: "bg-white",
                accentColor: "text-teal-600",
                warningColor: "text-red-600",
                textColor: "text-gray-800",
                navBtnColor: "bg-teal-600 hover:bg-teal-700",
                widgetBg: "bg-white border border-gray-200",
                clockBg: "bg-teal-100 text-teal-800"
            }
        };

        // --- UTILS (Funciones de negocio robustecidas contra datos nulos/incompletos) ---
        
        const calculateTimeDiff = (timestamp) => {
            if (!timestamp) return { days: 0, hours: 0 };
            const now = Date.now();
            let date;
            
            try {
                if (timestamp.toDate) { 
                    date = timestamp.toDate();
                } 
                else if (typeof timestamp === 'string' || typeof timestamp === 'number') {
                    date = new Date(timestamp);
                } 
                else if (timestamp instanceof Date) {
                    date = timestamp;
                } else {
                    return { days: 0, hours: 0 }; 
                }
                
                if (isNaN(date.getTime())) return { days: 0, hours: 0 };
            } catch (e) {
                return { days: 0, hours: 0 };
            }

            const diffMs = now - date.getTime();
            const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));
            const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            return { days: diffDays, hours: diffHours };
        };

        const calculateOrderStatus = (order) => {
            // Safety check: returns NULL if essential data is missing (NEW: Filters out incomplete data)
            if (!order || !order.progreso || !order.createdAt || !order.maquina || !order.codigo) {
                return null;
            }

            try {
                const finishedPackages = order.progreso.filter(p => p.finished).length;
                const totalPackages = order.progreso.length;
                
                const piecesFinished = order.progreso.filter(p => p.finished).reduce((sum, p) => sum + (Number(p.cantidad) || 0), 0);
                const piecesLeft = (Number(order.totalPedido) || 0) - piecesFinished;
                
                const efficiency = totalPackages > 0 ? (finishedPackages / totalPackages) * 100 : 0;
                
                let lastUpdateTime = order.createdAt; 
                order.progreso.forEach(p => {
                    if (p.fecha) {
                        const pDate = p.fecha.toDate ? p.fecha.toDate() : new Date(p.fecha);
                        const lastDate = lastUpdateTime.toDate ? lastUpdateTime.toDate() : new Date(lastUpdateTime);
                        if (pDate.getTime() > lastDate.getTime()) {
                            lastUpdateTime = p.fecha;
                        }
                    }
                });

                const timeSinceCreation = calculateTimeDiff(order.createdAt);
                const timeSinceLastUpdate = calculateTimeDiff(lastUpdateTime);
                
                let totalMinutesLeft = 0;
                if (order.subPiecesData && Array.isArray(order.subPiecesData)) {
                    order.subPiecesData.forEach(p => {
                        const packagesToFinish = order.progreso.filter(pkg => pkg.piezaNombre === p.pieza && !pkg.finished);
                        const totalPiecesInRemainingPackages = packagesToFinish.reduce((sum, pkg) => sum + (Number(pkg.cantidad) || 0), 0);
                        const pieceTime = Number(p.tiempo) || 0;
                        totalMinutesLeft += (totalPiecesInRemainingPackages * pieceTime);
                    });
                }

                const totalHoursLeft = totalMinutesLeft / 60;
                const daysLeft = Math.floor(totalHoursLeft / 24);
                const hoursLeft = Math.round(totalHoursLeft % 24);
                
                let statusMessage = '';
                let isWarning = false;

                if (piecesLeft <= 0) {
                    statusMessage = `‚úÖ ORDEN ${order.codigo} (MAQ #${order.maquina}) TERMINADA`;
                } else if (timeSinceLastUpdate.days >= 3) {
                    statusMessage = `üî¥ MAQ #${order.maquina}: Modelo ${order.codigo}. Sin actualizaci√≥n en ${timeSinceLastUpdate.days} d√≠as.`;
                    isWarning = true;
                } else if (totalHoursLeft > 0) {
                     statusMessage = `‚è±Ô∏è MAQ #${order.maquina}: Falta ${daysLeft}D ${hoursLeft}H. Efic: ${efficiency.toFixed(0)}%.`;
                     if (efficiency < 50) isWarning = true;
                } else {
                     statusMessage = `MAQ #${order.maquina}: Modelo ${order.codigo}. EN PROCESO.`;
                }

                return { statusMessage, isWarning, maquina: order.maquina, codigo: order.codigo };
            } catch (e) {
                // If a critical error occurs during complex calculation, filter it out.
                 console.error(`‚ùå Error Cr√≠tico al procesar orden ${order.codigo || 'N/A'}:`, e);
                 return null; 
            }
        };

        // --- NUEVO COMPONENTE: Cuadr√≠cula de Estado Parpadeante ---

        const StatusTile = ({ text, isWarning, theme }) => {
            // Randomize visual properties for the techno-effect
            const randomOpacity = useMemo(() => Math.random() * (0.95 - 0.4) + 0.4, []); 
            const randomDuration = useMemo(() => Math.random() * (4 - 1.5) + 1.5, []);

            const tileBg = isWarning ? 'bg-red-800/80' : 'bg-sky-800/80';
            const textColor = isWarning ? theme.warningColor : theme.accentColor;

            return (
                <div 
                    className={`p-3 rounded-lg shadow-xl transition-all border border-current/20 font-mono overflow-hidden`}
                    style={{ 
                        opacity: randomOpacity,
                        animation: `flicker ${randomDuration}s infinite alternate` 
                    }}
                >
                    <p className={`text-xs lg:text-sm font-bold truncate ${textColor}`}>
                        {text}
                    </p>
                </div>
            );
        };

        const FlickeringStatusGrid = ({ allStatuses, theme }) => {
            const TILE_COUNT = 30; // Un poco m√°s grande para llenar bien el espacio
            
            // Generate and randomize data points
            const dataPoints = useMemo(() => {
                if (allStatuses.length === 0) return Array(TILE_COUNT).fill({ text: "Conectando con la Matriz de Datos...", isWarning: false });
                
                const points = [];
                for (let i = 0; i < TILE_COUNT; i++) {
                    // Cycle through the statuses array
                    points.push(allStatuses[i % allStatuses.length]);
                }
                
                // Shuffle the array to make the display random
                for (let i = points.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [points[i], points[j]] = [points[j], points[i]];
                }
                
                return points;
            }, [allStatuses]);
            

            return (
                <div className="grid grid-cols-3 md:grid-cols-5 lg:grid-cols-6 gap-2 lg:gap-3 mt-10 w-full">
                    {dataPoints.map((data, index) => (
                        <StatusTile key={index} text={data.text} isWarning={data.isWarning} theme={theme} />
                    ))}
                </div>
            );
        };


        // --- COMPONENTES EXISTENTES (Actualizados con la l√≥gica de tema) ---

        const Clock = ({ theme }) => {
            const [time, setTime] = useState(new Date());
            useEffect(() => {
                const timer = setInterval(() => setTime(new Date()), 1000);
                return () => clearInterval(timer);
            }, []);
            
            const accentColor = theme.accentColor.replace('text-', 'text-');
            
            return (
                <div className={`text-center font-mono p-4 rounded-lg shadow-2xl transition-colors ${theme.clockBg} ${theme.textColor === 'text-white' ? 'text-white' : 'text-gray-800'}`}>
                    <div className="text-6xl lg:text-7xl font-black">{time.toLocaleTimeString('es-MX', { hour: '2-digit', minute: '2-digit', second: '2-digit' })}</div>
                    <div className={`text-sm font-semibold mt-1 ${accentColor}`}>{time.toLocaleDateString('es-MX', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
                </div>
            );
        };
        
        // ELIMINACI√ìN: NavButtons fue removido y su contenido movido al MainContent.
        
        const RadioPlayer = ({ theme }) => {
            const [stations, setStations] = useState([]);
            const [searchUrl, setSearchUrl] = useState('');
            const [name, setName] = useState('');
            const [currentStation, setCurrentStation] = useState(null);
            const audioRef = useRef(new Audio());
            
            useEffect(() => {
                const unsubscribe = db.collection('radioStations').onSnapshot(s => {
                    setStations(s.docs.map(d => ({ id: d.id, ...d.data() })));
                });
                audioRef.current.volume = 0.5;
                return () => { unsubscribe(); audioRef.current.pause(); };
            }, []);

            const playStation = (station) => {
                if (currentStation && currentStation.id === station.id) {
                    audioRef.current.pause();
                    setCurrentStation(null);
                } else {
                    audioRef.current.src = station.url;
                    audioRef.current.play().catch(e => console.error("Error al reproducir:", e));
                    setCurrentStation(station);
                }
            };

            const addStation = async () => {
                if (name && searchUrl) {
                    await db.collection('radioStations').add({ name, url: searchUrl, addedAt: firebase.firestore.FieldValue.serverTimestamp() });
                    setName('');
                    setSearchUrl('');
                }
            };
            
            const deleteStation = async (id) => {
                if (window.confirm("¬øSeguro que quieres eliminar esta estaci√≥n?")) {
                    await db.collection('radioStations').doc(id).delete();
                    if (currentStation && currentStation.id === id) {
                         audioRef.current.pause();
                         setCurrentStation(null);
                    }
                }
            };
            
            const accentTextClass = theme.accentColor;
            const stationBg = theme.textColor === 'text-white' ? 'bg-slate-700 hover:bg-slate-600' : 'bg-gray-200 hover:bg-gray-300';
            const playingBg = theme.accentColor.replace('text-', 'bg-').replace('-400', '-200');
            const playingText = theme.accentColor.replace('text-', 'text-');
            const inputBg = theme.textColor === 'text-white' ? 'bg-slate-900 border-slate-600 text-white' : 'bg-white border-gray-300 text-gray-800';
            const saveBtnColor = theme.navBtnColor;

            return (
                <div className={`mt-6 p-4 rounded-xl shadow-lg transition-colors ${theme.widgetBg} ${theme.textColor}`} style={{ '--accent-color': theme.accentColor.replace('text-', '#') }}>
                    <h3 className={`font-bold text-xl mb-3 flex items-center gap-2 ${accentTextClass}`}><Icon name="radio" size={20}/> Radio FM/Internet</h3>
                    
                    <div className="flex items-center gap-2 mb-3">
                        <input type="range" min="0" max="1" step="0.01" defaultValue="0.5" onChange={(e) => audioRef.current.volume = e.target.value} className={`flex-1 accent-current ${theme.accentColor.replace('text-', '')}`} />
                        <Icon name="volume-2" size={18} className="text-current"/>
                    </div>

                    <div className="radio-list space-y-2 mb-3 border-b border-current/30 pb-3">
                        {stations.map(s => (
                            <div key={s.id} className={`flex items-center justify-between text-sm p-2 rounded transition-colors ${stationBg} ${currentStation?.id === s.id ? `${playingBg} ${playingText} font-bold` : ''}`}>
                                <div className="truncate">{s.name}</div>
                                <div className="flex gap-1 shrink-0">
                                    <button onClick={() => playStation(s)} className={`p-1 rounded transition-colors text-white ${currentStation?.id === s.id ? 'bg-red-500 hover:bg-red-600' : 'bg-green-500 hover:bg-green-600'}`}>
                                        <Icon name={currentStation?.id === s.id ? "pause" : "play"} size={16}/>
                                    </button>
                                    <button onClick={() => deleteStation(s.id)} className="p-1 bg-red-500/10 text-red-400 rounded hover:bg-red-500/20">
                                         <Icon name="trash-2" size={16}/>
                                    </button>
                                </div>
                            </div>
                        ))}
                        {stations.length === 0 && <p className="text-sm text-current/70 text-center">No hay estaciones guardadas.</p>}
                    </div>
                    
                    <p className="text-sm font-bold text-current/80 mb-1">AGREGAR ESTACI√ìN:</p>
                    <input type="text" placeholder="Nombre (Ej: La Zeta)" value={name} onChange={(e) => setName(e.target.value)} className={`w-full p-2 mb-1 text-sm border rounded ${inputBg}`} />
                    <input type="url" placeholder="URL de Stream (.mp3, .m3u, .m3u8)" value={searchUrl} onChange={(e) => setSearchUrl(e.target.value)} className={`w-full p-2 mb-2 text-sm border rounded ${inputBg}`} />
                    <button onClick={addStation} disabled={!name || !searchUrl} className={`w-full text-white font-bold p-3 rounded-lg text-sm transition-all shadow-md ${saveBtnColor} disabled:opacity-50 disabled:cursor-not-allowed`}>
                        <Icon name="save" size={18} className="inline mr-1"/> Guardar Estaci√≥n
                    </button>
                </div>
            );
        };

        const WeatherWidget = ({ theme }) => {
            const city = "LE√ìN, GTO.";
            const temp = "25¬∞C";
            const icon = "sun";
            const desc = "Soleado";

            const accentTextClass = theme.accentColor;

            return (
                <div className={`p-4 rounded-xl shadow-lg transition-colors ${theme.widgetBg} ${theme.textColor}`}>
                    <h3 className={`font-bold text-xl mb-3 flex items-center gap-2 ${accentTextClass}`}><Icon name="cloud-lightning" size={20}/> Clima de la Zona</h3>
                    <div className="flex justify-between items-center p-2">
                        <div>
                            <div className={`text-5xl font-black ${accentTextClass}`}>{temp}</div>
                            <div className="text-base font-semibold text-current/80">{desc}</div>
                        </div>
                        <Icon name={icon} size={64} className="text-yellow-400 drop-shadow-lg"/>
                    </div>
                    <div className="text-xs mt-3 text-current/60 font-bold border-t border-current/30 pt-2">Ubicaci√≥n: {city} (Simulado)</div>
                </div>
            );
        };
        
        const ThemeSwitcher = ({ theme, setTheme }) => {
            const themesArray = Object.values(themeConfig);
            
            return (
                <div className="p-4 rounded-xl shadow-lg bg-slate-700/50 backdrop-blur-sm text-white mt-6">
                    <h3 className="font-bold text-xl mb-3 flex items-center gap-2 text-white"><Icon name="palette" size={20}/> Temas</h3>
                    <div className="flex space-x-3">
                        {themesArray.map((t) => (
                            <button 
                                key={t.id} 
                                onClick={() => setTheme(t.id)} 
                                className={`flex-1 p-2 rounded-lg text-sm font-semibold transition-all shadow-md ${t.id === theme.id ? 'ring-4 ring-offset-2 ring-sky-500' : 'hover:opacity-80'}`}
                                style={{backgroundColor: t.secondaryBg.replace('bg-', ''), color: t.textColor.includes('white') ? 'white' : 'black'}}
                            >
                                {t.name}
                            </button>
                        ))}
                    </div>
                </div>
            )
        }

        // --- COMPONENTE PRINCIPAL DE LA P√ÅGINA ---

        const App = () => {
            const [orders, setOrders] = useState([]);
            const [inventory, setInventory] = useState([]);
            const [currentThemeId, setCurrentThemeId] = useState(localStorage.getItem('dashboardTheme') || 'darkIndustrial');
            
            const theme = themeConfig[currentThemeId];

            // Guarda el tema en localStorage
            useEffect(() => {
                localStorage.setItem('dashboardTheme', currentThemeId);
            }, [currentThemeId]);
            
            // Carga inicial de datos
            useEffect(() => {
                const u1 = db.collection('orders').where('status', '!=', 'ARCHIVADO').onSnapshot(s => setOrders(s.docs.map(d=>d.data()).filter(d=>d.progreso && d.progreso.length > 0)));
                const u2 = db.collection('inventory').doc('main').onSnapshot(d => setInventory(d.data()?.items || []));
                return () => { u1(); u2(); };
            }, []);

            const allStatuses = useMemo(() => {
                const statuses = [];
                const inventoryCopy = [...inventory];
                
                // 1. Agregar estados de Inventario (Solo los que est√°n bajos o al azar)
                const lowStockItems = inventoryCopy.filter(item => Number(item.stock) < Number(item.minStock));
                
                // Mezcla √≠tems bajos y √≠tems normales para tener variedad
                const mixedItems = [...lowStockItems];
                inventoryCopy.forEach(item => {
                    if (!mixedItems.includes(item)) mixedItems.push(item);
                });
                
                for (let i = 0; i < Math.min(6, mixedItems.length); i++) {
                    const item = mixedItems[i];
                    const text = `üìä INV: ${item.material} ${item.calibre || ''} Stock ${Number(item.stock).toFixed(1)} kg.`;
                    const isWarn = Number(item.stock) < Number(item.minStock);
                    
                    statuses.push({ text: isWarn ? `‚ö†Ô∏è ${text}` : text, isWarning: isWarn, type: 'inventory' });
                }

                // 2. Agregar estados de √ìrdenes (Solo √≥rdenes activas con tiempo restante o advertencia)
                const relevantOrders = orders
                    .map(calculateOrderStatus)
                    .filter(s => s); // FILTRADO CLAVE: Solo se incluyen los resultados que NO son nulos (sin errores/datos incompletos)
                    
                relevantOrders.forEach(status => {
                    statuses.push({
                        text: status.statusMessage,
                        isWarning: status.isWarning,
                        type: 'order',
                    });
                });
                
                // 3. Mensajes de estado general/bienvenida
                if (statuses.length < 5) { // Garantizamos que haya algunos mensajes de relleno si la BD est√° vac√≠a/peque√±a
                     statuses.push({ text: "OPERACI√ìN EN L√çNEA. FLUJO DE DATOS ESTABLE.", isWarning: false, type: 'idle' });
                     statuses.push({ text: "BIENVENIDO. SISTEMA DE PRODUCCI√ìN V01.", isWarning: false, type: 'welcome' });
                }

                return statuses;
            }, [orders, inventory]);
            
            // Aplicar el tema al <body>
            useEffect(() => {
                document.body.className = theme.primaryBg;
                // Ajuste para el color de la barra de desplazamiento
                document.documentElement.style.setProperty('--accent-color', theme.accentColor.replace('text-', '#'));
            }, [theme]);
            

            return (
                <div className="dashboard-grid">
                    {/* --- Contenido Principal (Visualizaci√≥n de Datos) --- */}
                    <div className={`main-content p-4 lg:p-12 flex flex-col items-center justify-start transition-colors ${theme.primaryBg}`}>
                        <div className="text-center w-full max-w-6xl mx-auto">
                            <h1 className={`text-5xl lg:text-7xl font-extrabold ${theme.accentColor} mb-2 tracking-tighter`}>
                                SWEATERS LILIANA
                            </h1>
                            <h2 className={`text-lg lg:text-xl font-bold ${theme.textColor} opacity-70 mb-8`}>
                                DASHBOARD PRINCIPAL <span className="text-yellow-500">2026 v01</span>
                            </h2>
                            
                            {/* NUEVA CUADR√çCULA DE ESTADO */}
                            <FlickeringStatusGrid allStatuses={allStatuses} theme={theme} />
                            
                            <div className="mt-12 w-full max-w-lg mx-auto">
                                <Clock theme={theme} />
                            </div>
                            
                            {/* NUEVOS ENLACES PRINCIPALES IMPONENTES */}
                            <div className="mt-8 w-full max-w-6xl mx-auto px-4 lg:px-0">
                                {/* Fila 1: INVENTARIO (Izquierda) y SANTONI (Derecha - Resaltado como activo) */}
                                <div className="flex justify-between items-end">
                                    <a 
                                        href="https://jesusvn1993mplvt3-ai.github.io/Doc/" 
                                        target="_blank" 
                                        rel="noopener noreferrer" 
                                        className={`font-black text-5xl md:text-6xl lg:text-7xl transition-colors hover:opacity-80 ${theme.accentColor.replace('text-sky-400', 'text-indigo-400').replace('text-teal-600', 'text-indigo-600')}`}
                                        style={{textShadow: '0 0 5px rgba(0,0,0,0.4)'}}
                                    >
                                        INVENTARIO
                                    </a>
                                    {/* SANTONI - P√°gina actual, estilizado para verse como un bot√≥n activo/pegado a la derecha */}
                                    <div 
                                        className={`text-4xl md:text-5xl lg:text-6xl font-black p-1 md:p-2 rounded-lg transition-all ${theme.accentColor.replace('text-sky-400', 'text-red-400').replace('text-teal-600', 'text-red-600')}`} 
                                        style={{textShadow: '0 0 5px rgba(0,0,0,0.4)'}}
                                    >
                                        SANTONI
                                    </div>
                                </div>
                                
                                {/* Fila 2: CALCET√çN (Izquierda) */}
                                <div className="flex justify-start items-end mt-4">
                                    <a 
                                        href="https://sweaters-liliana.github.io/MAES26/" 
                                        target="_blank" 
                                        rel="noopener noreferrer" 
                                        className={`font-black text-5xl md:text-6xl lg:text-7xl transition-colors hover:opacity-80 ${theme.accentColor.replace('text-sky-400', 'text-cyan-400').replace('text-teal-600', 'text-cyan-600')}`}
                                        style={{textShadow: '0 0 5px rgba(0,0,0,0.4)'}}
                                    >
                                        CALCET√çN
                                    </a>
                                </div>
                                
                                <hr className={`mt-8 border-t-4 ${theme.textColor === 'text-white' ? 'border-slate-700' : 'border-gray-300'}`}/>
                            </div>
                            
                        </div>
                    </div>
                    
                    {/* --- Barra Lateral (Widgets y Navegaci√≥n) --- */}
                    <div className={`sidebar p-6 lg:p-8 transition-colors ${theme.secondaryBg} ${theme.textColor}`}>
                        <WeatherWidget theme={theme} />
                        <RadioPlayer theme={theme} />
                        <ThemeSwitcher theme={theme} setTheme={setCurrentThemeId} />
                        {/* NavButtons ha sido movido a la secci√≥n principal */}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>